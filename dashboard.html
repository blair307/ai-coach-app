<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Entrepreneur Emotional Health</title>
    <link rel="stylesheet" href="styles.css">
    <script src="sidebar-toggle.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>EEH</h2>
            </div>
            <ul class="sidebar-menu">
                <li><a href="dashboard.html" class="menu-item active">
                    Dashboard
                </a></li>
                <li><a href="ai-coach.html" class="menu-item">
                    AI Coach
                </a></li>
                <li><a href="community.html" class="menu-item">
                    Community
                </a></li>
                <li><a href="notifications.html" class="menu-item">
                    Notifications
                    <span class="notification-badge" id="notificationBadge">3</span>
                </a></li>
                <li><a href="billing.html" class="menu-item">
                    Billing
                </a></li>
                <li><a href="#" class="menu-item" onclick="logout()">
                    Logout
                </a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>Dashboard</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="startCoachingSession()">
                        Start Coaching Session
                    </button>
                </div>
            </header>

            <!-- Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- Progress Overview -->
                <div class="dashboard-card">
                    <h3>Your Progress</h3>
                    <div class="stats-grid">
                        <div class="stat">
                            <div class="stat-number">127</div>
                            <div class="stat-label">Coaching Sessions</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">42</div>
                            <div class="stat-label">Days Active</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">18</div>
                            <div class="stat-label">Community Posts</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number">6</div>
                            <div class="stat-label">Active Goals</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-card">
                    <h3>Recent Activity</h3>
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-content">
                                <p>Completed emotional intelligence assessment</p>
                                <small>2 hours ago</small>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-content">
                                <p>Joined discussion in Business Growth room</p>
                                <small>4 hours ago</small>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-content">
                                <p>Set new quarterly business goals</p>
                                <small>Yesterday</small>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-content">
                                <p>Completed stress management workshop</p>
                                <small>2 days ago</small>
                            </div>
                        </div>
                    </div>
                    <a href="#" class="view-all-link">View All Activity</a>
                </div>

                <!-- Quick Actions -->
                <div class="dashboard-card">
                    <h3>Quick Actions</h3>
                    <div class="quick-actions">
                        <a href="ai-coach.html" class="quick-action">
                            <div class="action-text">
                                <h4>Chat with AI Coach</h4>
                                <p>Get personalized guidance</p>
                            </div>
                        </a>
                        <a href="community.html" class="quick-action">
                            <div class="action-text">
                                <h4>Join Community</h4>
                                <p>Connect with entrepreneurs</p>
                            </div>
                        </a>
                        <a href="#" class="quick-action" onclick="manageGoals()">
                            <div class="action-text">
                                <h4>Manage Goals</h4>
                                <p>Add, edit, or review your goals</p>
                            </div>
                        </a>
                        <a href="billing.html" class="quick-action">
                            <div class="action-text">
                                <h4>View Billing</h4>
                                <p>Check subscription & usage</p>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Notifications Preview -->
                <div class="dashboard-card">
                    <h3>Recent Notifications</h3>
                    <div class="notifications-preview">
                        <div class="notification-item unread">
                            <div class="notification-content">
                                <p>New coaching insights available</p>
                                <small>2 hours ago</small>
                            </div>
                        </div>
                        <div class="notification-item unread">
                            <div class="notification-content">
                                <p>Sarah mentioned you in Business Growth</p>
                                <small>4 hours ago</small>
                            </div>
                        </div>
                        <div class="notification-item">
                            <div class="notification-content">
                                <p>Weekly progress report ready</p>
                                <small>1 day ago</small>
                            </div>
                        </div>
                    </div>
                    <a href="notifications.html" class="view-all-link">View All Notifications</a>
                </div>

                <!-- Current Goals -->
                <div class="dashboard-card">
                    <h3>Current Goals</h3>
                    <div class="goals-list">
                        <div class="goal-item">
                            <input type="checkbox" checked id="goal1">
                            <label for="goal1">Improve work-life balance</label>
                        </div>
                        <div class="goal-item">
                            <input type="checkbox" id="goal2">
                            <label for="goal2">Increase emotional intelligence</label>
                        </div>
                        <div class="goal-item">
                            <input type="checkbox" checked id="goal3">
                            <label for="goal3">Build stronger team relationships</label>
                        </div>
                        <div class="goal-item">
                            <input type="checkbox" id="goal4">
                            <label for="goal4">Develop stress management skills</label>
                        </div>
                    </div>
                    <button class="btn btn-outline btn-small" onclick="addGoal()">Add New Goal</button>
                </div>

                <!-- Weekly Insights -->
                <div class="dashboard-card">
                    <h3>Recent Insights</h3>
                    <div class="insights-list" id="insightsList">
                        <!-- Insights will be populated by JavaScript based on user data -->
                        <div class="empty-insights" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                            <p>Start chatting with your AI coach to generate personalized insights!</p>
                            <button class="btn btn-primary btn-small" onclick="startCoachingSession()" style="margin-top: 1rem;">
                                Start Your First Session
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="dashboard.js"></script>
    // Sidebar Toggle Functionality - Clean Version

// Initialize sidebar toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    initializeSidebarToggle();
});

function initializeSidebarToggle() {
    // Create toggle button if it doesn't exist
    if (!document.querySelector('.sidebar-toggle')) {
        createSidebarToggle();
    }
    
    // Load saved sidebar state
    loadSidebarState();
    
    // Add keyboard shortcut (Ctrl/Cmd + B)
    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
            e.preventDefault();
            toggleSidebar();
        }
    });
}

function createSidebarToggle() {
    const toggleButton = document.createElement('button');
    toggleButton.className = 'sidebar-toggle';
    toggleButton.innerHTML = '☰';
    toggleButton.onclick = toggleSidebar;
    toggleButton.title = 'Toggle Sidebar (Ctrl+B)';
    
    document.body.appendChild(toggleButton);
}

function toggleSidebar() {
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        handleMobileToggle();
        return;
    }
    
    const sidebar = document.querySelector('.sidebar');
    const toggleButton = document.querySelector('.sidebar-toggle');
    
    if (!sidebar) return;
    
    const isCollapsed = sidebar.classList.contains('collapsed');
    
    if (isCollapsed) {
        // Expand sidebar
        sidebar.classList.remove('collapsed');
        toggleButton.innerHTML = '☰';
        toggleButton.title = 'Collapse Sidebar (Ctrl+B)';
        saveSidebarState(false);
        
        // Show text with animation delay
        setTimeout(function() {
            const menuItems = sidebar.querySelectorAll('.menu-item, .sidebar-header h2');
            menuItems.forEach(function(item) {
                item.style.opacity = '1';
                item.style.visibility = 'visible';
            });
        }, 150);
        
    } else {
        // Collapse sidebar
        sidebar.classList.add('collapsed');
        toggleButton.innerHTML = '→';
        toggleButton.title = 'Expand Sidebar (Ctrl+B)';
        saveSidebarState(true);
        
        // Hide text immediately
        const menuItems = sidebar.querySelectorAll('.menu-item, .sidebar-header h2');
        menuItems.forEach(function(item) {
            item.style.opacity = '0';
            item.style.visibility = 'hidden';
        });
    }
    
    // Trigger a custom event for other components to react
    window.dispatchEvent(new CustomEvent('sidebarToggle', { 
        detail: { collapsed: !isCollapsed } 
    }));
}

function saveSidebarState(collapsed) {
    localStorage.setItem('eeh_sidebar_collapsed', collapsed.toString());
}

function loadSidebarState() {
    const sidebar = document.querySelector('.sidebar');
    const toggleButton = document.querySelector('.sidebar-toggle');
    
    if (!sidebar || !toggleButton) return;
    
    const savedState = localStorage.getItem('eeh_sidebar_collapsed');
    const isCollapsed = savedState === 'true';
    
    if (isCollapsed) {
        sidebar.classList.add('collapsed');
        toggleButton.innerHTML = '→';
        toggleButton.title = 'Expand Sidebar (Ctrl+B)';
        
        // Hide text
        const menuItems = sidebar.querySelectorAll('.menu-item, .sidebar-header h2');
        menuItems.forEach(function(item) {
            item.style.opacity = '0';
            item.style.visibility = 'hidden';
        });
    } else {
        sidebar.classList.remove('collapsed');
        toggleButton.innerHTML = '☰';
        toggleButton.title = 'Collapse Sidebar (Ctrl+B)';
    }
}

// Mobile-specific functions
function handleMobileToggle() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay') || createSidebarOverlay();
    
    if (!sidebar) return;
    
    const isOpen = sidebar.classList.contains('open');
    
    if (isOpen) {
        closeMobileSidebar();
    } else {
        openMobileSidebar();
    }
}

function createSidebarOverlay() {
    const overlay = document.createElement('div');
    overlay.className = 'sidebar-overlay';
    overlay.onclick = closeMobileSidebar;
    document.body.appendChild(overlay);
    return overlay;
}

function openMobileSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    
    if (sidebar) sidebar.classList.add('open');
    if (overlay) overlay.classList.add('active');
    
    // Prevent body scroll
    document.body.style.overflow = 'hidden';
}

function closeMobileSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    
    if (sidebar) sidebar.classList.remove('open');
    if (overlay) overlay.classList.remove('active');
    
    // Restore body scroll
    document.body.style.overflow = '';
}

// Handle window resize
window.addEventListener('resize', function() {
    const sidebar = document.querySelector('.sidebar');
    const isMobile = window.innerWidth <= 768;
    
    if (!isMobile && sidebar) {
        // Reset mobile classes when switching to desktop
        sidebar.classList.remove('open');
        const overlay = document.querySelector('.sidebar-overlay');
        if (overlay) overlay.classList.remove('active');
        document.body.style.overflow = '';
    }
});

console.log('Sidebar toggle loaded successfully');
</body>
</html>
